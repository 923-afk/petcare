<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase ç™»å…¥æ¸¬è©¦</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .info { background: #d1ecf1; border-color: #bee5eb; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        .demo-button {
            background: #28a745;
            margin: 10px 5px;
            padding: 15px 25px;
            font-size: 16px;
        }
        .demo-button:hover { background: #1e7e34; }
        input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
        }
        .url-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Supabase ç™»å…¥æ¸¬è©¦</h1>
        
        <div class="test-section info">
            <h3>ğŸ“‹ è¨­å®šæ­¥é©Ÿ</h3>
            <p>1. åœ¨ Supabase ä¸­å‰µå»ºå°ˆæ¡ˆ</p>
            <p>2. è¨­å®šç’°å¢ƒè®Šæ•¸</p>
            <p>3. å‰µå»ºæ¸¬è©¦ç”¨æˆ¶</p>
            <p>4. æ¸¬è©¦ç™»å…¥åŠŸèƒ½</p>
        </div>

        <div class="test-section">
            <h3>ğŸŒ Supabase é…ç½®</h3>
            <input type="text" id="supabaseUrl" class="url-input" placeholder="https://your-project.supabase.co">
            <input type="text" id="supabaseKey" class="url-input" placeholder="your-anon-key">
            <button onclick="initSupabase()">åˆå§‹åŒ– Supabase</button>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª é€£æ¥æ¸¬è©¦</h3>
            <button onclick="testConnection()">æ¸¬è©¦ Supabase é€£æ¥</button>
            <div id="connectionResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ‘¤ ç™»å…¥æ¸¬è©¦</h3>
            <input type="email" id="email" placeholder="é›»å­éƒµä»¶" value="owner.demo@example.com">
            <input type="password" id="password" placeholder="å¯†ç¢¼" value="demo1234">
            <button onclick="testLogin()">æ¸¬è©¦ç™»å…¥</button>
            <div id="loginResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ” ç”¨æˆ¶ä¿¡æ¯</h3>
            <button onclick="getCurrentUser()">ç²å–ç•¶å‰ç”¨æˆ¶</button>
            <button onclick="signOut()">ç™»å‡º</button>
            <div id="userResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ“ è¨­å®šæŒ‡å—</h3>
            <div id="setupGuide" class="result">
1. å‰å¾€ https://supabase.com
2. å‰µå»ºæ–°å°ˆæ¡ˆ
3. åœ¨ Authentication â†’ Users ä¸­å‰µå»ºç”¨æˆ¶
4. è¤‡è£½å°ˆæ¡ˆ URL å’Œ API Key
5. åœ¨æ‡‰ç”¨ç¨‹å¼ä¸­è¨­å®šç’°å¢ƒè®Šæ•¸
            </div>
        </div>
    </div>

    <script>
        let supabase = null;
        
        function initSupabase() {
            const url = document.getElementById('supabaseUrl').value.trim();
            const key = document.getElementById('supabaseKey').value.trim();
            
            if (!url || !key) {
                showResult('connectionResult', 'âŒ è«‹è¼¸å…¥ Supabase URL å’Œ API Key', 'error');
                return;
            }
            
            try {
                supabase = window.supabase.createClient(url, key);
                showResult('connectionResult', 'âœ… Supabase åˆå§‹åŒ–æˆåŠŸ', 'success');
            } catch (error) {
                showResult('connectionResult', `âŒ åˆå§‹åŒ–å¤±æ•—: ${error.message}`, 'error');
            }
        }
        
        async function testConnection() {
            if (!supabase) {
                showResult('connectionResult', 'âŒ è«‹å…ˆåˆå§‹åŒ– Supabase', 'error');
                return;
            }
            
            try {
                const { data, error } = await supabase.auth.getSession();
                if (error) {
                    showResult('connectionResult', `âŒ é€£æ¥éŒ¯èª¤: ${error.message}`, 'error');
                } else {
                    showResult('connectionResult', `âœ… é€£æ¥æˆåŠŸ\nSession: ${JSON.stringify(data, null, 2)}`, 'success');
                }
            } catch (error) {
                showResult('connectionResult', `âŒ é€£æ¥å¤±æ•—: ${error.message}`, 'error');
            }
        }
        
        async function testLogin() {
            if (!supabase) {
                showResult('loginResult', 'âŒ è«‹å…ˆåˆå§‹åŒ– Supabase', 'error');
                return;
            }
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            try {
                showResult('loginResult', 'ğŸ”„ æ­£åœ¨ç™»å…¥...', 'info');
                
                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password
                });
                
                if (error) {
                    showResult('loginResult', `âŒ ç™»å…¥å¤±æ•—: ${error.message}`, 'error');
                } else {
                    showResult('loginResult', `âœ… ç™»å…¥æˆåŠŸ!\nç”¨æˆ¶: ${JSON.stringify(data.user, null, 2)}`, 'success');
                }
            } catch (error) {
                showResult('loginResult', `âŒ ç™»å…¥éŒ¯èª¤: ${error.message}`, 'error');
            }
        }
        
        async function getCurrentUser() {
            if (!supabase) {
                showResult('userResult', 'âŒ è«‹å…ˆåˆå§‹åŒ– Supabase', 'error');
                return;
            }
            
            try {
                const { data: { user }, error } = await supabase.auth.getUser();
                
                if (error) {
                    showResult('userResult', `âŒ ç²å–ç”¨æˆ¶å¤±æ•—: ${error.message}`, 'error');
                } else if (user) {
                    showResult('userResult', `âœ… ç•¶å‰ç”¨æˆ¶:\n${JSON.stringify(user, null, 2)}`, 'success');
                } else {
                    showResult('userResult', 'â„¹ï¸ æ²’æœ‰ç™»å…¥çš„ç”¨æˆ¶', 'info');
                }
            } catch (error) {
                showResult('userResult', `âŒ éŒ¯èª¤: ${error.message}`, 'error');
            }
        }
        
        async function signOut() {
            if (!supabase) {
                showResult('userResult', 'âŒ è«‹å…ˆåˆå§‹åŒ– Supabase', 'error');
                return;
            }
            
            try {
                const { error } = await supabase.auth.signOut();
                
                if (error) {
                    showResult('userResult', `âŒ ç™»å‡ºå¤±æ•—: ${error.message}`, 'error');
                } else {
                    showResult('userResult', 'âœ… ç™»å‡ºæˆåŠŸ', 'success');
                }
            } catch (error) {
                showResult('userResult', `âŒ ç™»å‡ºéŒ¯èª¤: ${error.message}`, 'error');
            }
        }
        
        function showResult(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `result ${type}`;
        }
    </script>
</body>
</html>
